{% extends "index.html" %}
<!DOCTYPE html>
{% block style %}
<style>
  .rating {
    display: inline-flex;
      align-items: center;
      background-color: #4CAF50; /* Green background */
      color: white; /* White text */
      padding: 5px 6px;
      border-radius: 3px;
      font-family: Arial, sans-serif;
      font-size: 16px;
      margin: 6px 0px;
}
.rating.high {
    background-color: #4CAF50; /* Green background */
    color: white; /* White text */
}
.rating.low {
    background-color: #f44336; /* Red background */
    color: white; /* White text */
}
.star {
  margin-left: 3px;
  font-size: 14px; /* Slightly larger star */
}
</style> 
{% endblock style %}

<!-- ======= Product Section ======= -->

{% block product %}

{% for product,nSlides,AddedItems,space in allProds %}
<!-- Other product details here -->
<div class="container flex_space-around">
  <h3 class="my-3 text-md-right text-success bg-light">All FlashSale</h3>
</div>
<div class="container">
  <div class="row">
    {% for i in product|slice:":7" %}
    <div class="col-md-3 mt-3">
      <div class="card h-100 overflow-hidden">
        <div class="img-container">
          <img id='img-pops' src="/media/{{ i.image }}" alt="..." class="card-img-top cursor-hover img-fluid" />
          <a href="{% url 'EachProductDetails' i.id %}" class="btn btn-success btn-sm cart mt-2 view-button">View</a>
        </div>
        <div class="card-body d-flex flex-column">
          <h5 class="card-title" id="namepr{{ i.id }}" style="color: black;">
            {{ i.Product_name }}
          </h5>
          <p class="card-text" style="color: black;">
            {{ i.desc|slice:"0:50" }}.....
          </p>
          <div class="flex_space-around">
            <h6 class="card-title mt-auto" style="color: black;">
              Price: <span id="pricepr{{ i.id }}">₹{{ i.price }}</span>
            </h6>
            <div id="rating-display" class="rating" data-rating="{{i.rating_field}}">
              {{i.rating_field}}
              <span class="star">★</span>
          </div>
            <div id="divpr{{ i.id }}" class="divpr mt-2">
              <form action="{% url 'allProducts' %}" method="POST">
                {% csrf_token %}
                <input type="text" hidden name="productId" value="{{i.id}}">
                <input type="submit" id="pr{{i.id}}"  value="AddToCart" class="btn btn-success cart btn-sm mt-0">
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
<div class="container flex_space-around">
  <h3 class="my-3 text-md-right text-success bg-light">{{ product.name }}</h3> <!-- Example product name -->
  <form action="{% url 'allProducts_iteams' %}" method="POST">
    {% csrf_token %}
    <input type="hidden" name="product_category" value="All">
    <button type="submit" class="my-3 text-md-left btn-sm cart mt-2" style="padding: 10px; background: #E9607A; color: white; border: none;">See All</button>
  </form>
</div>
<br>
<br>
{% endfor %}
{% endblock product %}
{% block script %} 
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Get all rating display elements
        const ratingDisplays = document.querySelectorAll('.rating');
        
        ratingDisplays.forEach(function(ratingDisplay) {
            // Get the rating value from the data attribute
            const ratingValue = parseFloat(ratingDisplay.getAttribute('data-rating'));
            
            // Apply the appropriate class based on the rating value
            if (ratingValue >= 3.5) {
                ratingDisplay.classList.add('high');
            } else {
                ratingDisplay.classList.add('low');
            }
        });
    });
</script>

{% endblock %}
